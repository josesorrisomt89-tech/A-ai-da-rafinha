<div class="h-full bg-[var(--bg-page)] p-4">
  <h1 class="text-3xl font-bold text-[var(--text-primary)] mb-6 px-2">Painel da Cozinha</h1>
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 h-full">

    <!-- Accepted Orders -->
    <div class="bg-[var(--bg-card)] rounded-lg shadow-lg flex flex-col h-full">
      <h2 class="text-xl font-bold text-[var(--text-primary)] p-4 border-b border-[var(--border-color)]">
        Para Preparar ({{ acceptedOrders().length }})
      </h2>
      <div class="p-4 space-y-4 overflow-y-auto">
        @for (order of acceptedOrders(); track order.id) {
          <div class="border border-[var(--border-color)] rounded-lg shadow-sm">
            <div class="p-4 bg-[var(--bg-page)] rounded-t-lg">
                <p class="font-bold text-lg text-[var(--text-primary)]">{{ order.customerName }}</p>
                <p class="text-xs text-[var(--text-secondary)] font-mono">#{{ order.id }}</p>
            </div>
            <div class="p-4 space-y-3">
              @for(item of order.items; track item.id) {
                <div class="pb-2 border-b border-[var(--border-color)] last:border-b-0">
                  <p class="font-semibold text-[var(--text-primary)]">{{ item.product.name }} ({{ item.size.name }})</p>
                  
                  @for(group of groupToppingsByCategory(item.toppings); track group.categoryName) {
                    <div class="pl-2 mt-1">
                      <p class="text-xs italic text-[var(--text-secondary)]">{{ group.categoryName }}</p>
                      @for(toppingItem of group.toppings; track toppingItem.topping.id) {
                        <p class="text-sm pl-2 text-[var(--text-secondary)]">- {{ toppingItem.topping.name }}</p>
                      }
                    </div>
                  }
                  @if (item.notes) {
                    <p class="text-sm mt-2 p-2 bg-yellow-100 text-yellow-800 rounded-md">
                      <strong>Obs:</strong> {{ item.notes }}
                    </p>
                  }
                </div>
              }
            </div>
            <div class="p-4 border-t border-[var(--border-color)]">
              <button (click)="startPreparation(order)" class="w-full bg-blue-500 text-white font-bold py-3 rounded-lg hover:bg-blue-600 transition-colors">
                Iniciar Preparo
              </button>
            </div>
          </div>
        } @empty {
            <p class="text-center text-[var(--text-secondary)] py-10">Nenhum pedido para preparar.</p>
        }
      </div>
    </div>

    <!-- Preparing Orders -->
    <div class="bg-[var(--bg-card)] rounded-lg shadow-lg flex flex-col h-full">
      <h2 class="text-xl font-bold text-[var(--text-primary)] p-4 border-b border-[var(--border-color)]">
        Em Preparo ({{ preparingOrders().length }})
      </h2>
      <div class="p-4 space-y-4 overflow-y-auto">
        @for (order of preparingOrders(); track order.id) {
          <div class="border border-purple-300 rounded-lg shadow-sm">
            <div class="p-4 bg-purple-50 rounded-t-lg">
                <p class="font-bold text-lg text-purple-800">{{ order.customerName }}</p>
                <p class="text-xs text-purple-500 font-mono">#{{ order.id }}</p>
            </div>
            <div class="p-4 space-y-3">
              @for(item of order.items; track item.id) {
                <div class="pb-2 border-b border-[var(--border-color)] last:border-b-0">
                  <p class="font-semibold text-[var(--text-primary)]">{{ item.product.name }} ({{ item.size.name }})</p>
                  
                   @for(group of groupToppingsByCategory(item.toppings); track group.categoryName) {
                    <div class="pl-2 mt-1">
                      <p class="text-xs italic text-[var(--text-secondary)]">{{ group.categoryName }}</p>
                      @for(toppingItem of group.toppings; track toppingItem.topping.id) {
                        <p class="text-sm pl-2 text-[var(--text-secondary)]">- {{ toppingItem.topping.name }}</p>
                      }
                    </div>
                  }
                  @if (item.notes) {
                    <p class="text-sm mt-2 p-2 bg-yellow-100 text-yellow-800 rounded-md">
                      <strong>Obs:</strong> {{ item.notes }}
                    </p>
                  }
                </div>
              }
            </div>
            <div class="p-4 border-t border-[var(--border-color)]">
              <button (click)="finishPreparation(order)" class="w-full bg-green-500 text-white font-bold py-3 rounded-lg hover:bg-green-600 transition-colors">
                Finalizar e Enviar para o Caixa
              </button>
            </div>
          </div>
        } @empty {
            <p class="text-center text-[var(--text-secondary)] py-10">Nenhum pedido em preparo.</p>
        }
      </div>
    </div>

  </div>
</div>